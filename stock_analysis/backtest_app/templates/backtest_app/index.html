{% extends 'base/base.html' %}
{% block body %}
<h1>バックテストを実行</h1>

{% if form.errors %}
    <div style="color: red;">
        <h3>フォームエラー:</h3>
        <ul>
            {% for field, errors in form.errors.items %}
                <li>{{ field }}: {{ errors|join:", " }}</li>
            {% endfor %}
        </ul>
    </div>
{% endif %}

<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">実行</button>
</form>

<form method="post" action="{% url 'update_stock_data' %}">
    {% csrf_token %}
    <button type="submit">最新データを更新</button>
</form>

{% if result_data %}
    <h2>バックテスト結果</h2>
    <pre>{{ result_data|safe }}</pre>
{% else %}
    <p>バックテスト結果がありません。</p>
{% endif %}

{% if graph_html %}
    <h2>グラフ</h2>
    <div>{{ graph_html|safe }}</div>
{% else %}
    <p>グラフがありません。</p>
{% endif %}
{% endblock %}